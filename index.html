<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Zona Tadeo — Moda urbana universitaria</title>
  <meta name="description" content="Zona Tadeo - Moda urbana universitaria. Tienda online." />
  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <!-- PayPal SDK: sandbox client-id. Replace 'sb' with your live client-id when ready -->
  <script src="https://www.paypal.com/sdk/js?client-id=sb&currency=COP" defer></script>

  <style>
    :root{
      --bg: #f7f8fa;
      --card: #ffffff;
      --muted: #6b7280;
      --text: #0b1220;
      --accent: #0b4f8a; /* azul oscuro */
      --glass: rgba(11,18,32,0.04);
      --radius: 14px;
      --gap: 18px;
      --max-width: 1200px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: 'Poppins', system-ui, -apple-system, sans-serif;
      background:var(--bg);
      color:var(--text);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    /* Sticky header */
    header{
      position:sticky; top:0; z-index:100;
      backdrop-filter: blur(6px);
      background: linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.80));
      border-bottom:1px solid rgba(11,18,32,0.06);
      padding:10px 20px;
      display:flex; align-items:center; justify-content:space-between;
      box-shadow:0 4px 14px rgba(11,18,32,0.03);
    }
    .container{max-width:var(--max-width); margin:0 auto; width:100%;}
    .brand{display:flex; align-items:center; gap:14px;}
    .logo-preview{width:56px; height:56px; border-radius:10px; overflow:hidden; background:linear-gradient(180deg,#e6f2ff, #dff0ff); display:flex; align-items:center; justify-content:center; font-weight:700; color:var(--accent); border:1px solid rgba(11,18,32,0.04)}
    .brand h1{font-family: 'Playfair Display', serif; font-size:1.05rem; margin:0; color:var(--text)}
    .brand p{margin:0; font-size:0.78rem; color:var(--muted)}
    .header-actions{display:flex; gap:10px; align-items:center}
    .upload-btn{font-size:0.8rem; padding:8px 10px; border-radius:10px; background:transparent; border:1px dashed rgba(11,18,32,0.06); cursor:pointer}
    .search{padding:8px 12px; background:var(--card); border-radius:10px; display:flex; align-items:center; gap:8px; border:1px solid rgba(11,18,32,0.04)}
    .search input{border:0; outline:none; background:transparent; font-size:0.95rem; color:var(--text)}

    main{padding:28px 20px;}
    .hero{max-width:var(--max-width); margin:0 auto 20px; display:flex; align-items:center; justify-content:space-between; gap:20px}
    .hero-left{flex:1}
    .hero h2{font-family: 'Playfair Display', serif; font-size:1.6rem; margin:0; color:var(--accent)}
    .hero p{margin:8px 0 0; color:var(--muted); max-width:520px}

    .layout{max-width:var(--max-width); margin:18px auto; display:grid; grid-template-columns: 1fr 360px; gap:26px}
    @media (max-width:1000px){ .layout{grid-template-columns: 1fr} .aside{order:2} }

    /* Grid */
    .grid{display:grid; grid-template-columns: repeat(3, 1fr); gap:18px}
    @media (max-width:900px){ .grid{grid-template-columns:repeat(2,1fr)} }
    @media (max-width:560px){ .grid{grid-template-columns:1fr} }

    .card{
      background:var(--card);
      border-radius:var(--radius);
      padding:12px;
      border:1px solid rgba(11,18,32,0.04);
      display:flex; flex-direction:column; gap:12px;
      transition: transform .28s ease, box-shadow .28s ease;
    }
    .card:hover{ transform: translateY(-8px); box-shadow: 0 18px 40px rgba(11,18,32,0.06) }
    .thumb{width:100%; height:260px; border-radius:10px; overflow:hidden; background:var(--glass)}
    .thumb img{width:100%; height:100%; object-fit:cover; display:block; transition: transform .45s ease}
    .card:hover .thumb img{ transform: scale(1.04) }
    .meta{display:flex; justify-content:space-between; align-items:center; gap:10px}
    .meta .name{font-weight:600}
    .meta .price{color:var(--accent); font-weight:700}

    .desc{color:var(--muted); font-size:0.92rem; min-height:36px}

    .card .actions{display:flex; gap:10px; margin-top:auto}
    .btn{padding:9px 12px; border-radius:10px; border:0; cursor:pointer; font-weight:600}
    .btn.primary{background:linear-gradient(90deg,var(--accent), #2b6ea8); color: #fff}
    .btn.ghost{background:transparent; border:1px solid rgba(11,18,32,0.06); color:var(--muted)}

    /* Aside cart */
    .aside{background:var(--card); border-radius:var(--radius); padding:16px; border:1px solid rgba(11,18,32,0.04); position:sticky; top:78px; align-self:start}
    .cart-header{display:flex; justify-content:space-between; align-items:center; margin-bottom:8px}
    .cart-list{list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:12px; max-height:360px; overflow:auto}
    .cart-item{display:flex; gap:10px; align-items:center; background:rgba(11,18,32,0.02); padding:8px; border-radius:10px}
    .ci-thumb{width:64px; height:64px; border-radius:8px; overflow:hidden; flex-shrink:0}
    .ci-thumb img{width:100%; height:100%; object-fit:cover}
    .ci-meta{flex:1}
    .muted{color:var(--muted)}
    .badge{background:var(--accent); color:#fff; padding:6px 8px; border-radius:999px; font-weight:700}
    .small-ghost{padding:6px 8px; border-radius:8px; border:1px solid rgba(11,18,32,0.06); background:transparent; cursor:pointer; font-size:0.85rem}

    .total-row{display:flex; justify-content:space-between; align-items:center; margin-top:12px; font-weight:700}
    .checkout{margin-top:12px; display:flex; gap:8px; flex-direction:column}

    footer{max-width:var(--max-width); margin:36px auto; padding:28px 18px; background:transparent; display:flex; gap:28px; flex-wrap:wrap}
    .about{flex:1; min-width:260px}
    .contact{width:320px; min-width:260px}
    footer h3{margin:0 0 8px 0; font-family:'Playfair Display', serif; color:var(--accent)}
    footer p{margin:6px 0; color:var(--muted); font-size:0.95rem}

    /* tiny toast */
    .toast{position:fixed; right:18px; bottom:18px; background:#041425; color:#fff; padding:10px 14px; border-radius:10px; z-index:200}
  </style>
</head>
<body>
  <header>
    <div class="container" style="display:flex;align-items:center;justify-content:space-between;gap:16px">
      <div class="brand">
        <div id="logoPreview" class="logo-preview">ZT</div>
        <div>
          <h1>Zona Tadeo</h1>
          <p>Moda urbana universitaria</p>
        </div>
      </div>

      <div class="header-actions">
        <label class="upload-btn" title="Subir logo (PNG/SVG)">
          Subir logo
          <input id="logoInput" type="file" accept="image/*" style="display:none" />
        </label>
        <div class="search" aria-hidden>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none"><path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/><circle cx="11" cy="11" r="6" stroke="currentColor" stroke-width="1.5"/></svg>
          <input id="globalSearch" placeholder="Buscar producto..." />
        </div>
      </div>
    </div>
  </header>

  <main>
    <section class="hero container">
      <div class="hero-left">
        <h2>Zona Tadeo</h2>
        <p>Moda urbana universitaria pensada para expresar identidad y creatividad — piezas pensadas para la vida en campus y la ciudad.</p>
      </div>
      <div style="display:flex; gap:10px; align-items:center">
        <div style="text-align:right">
          <div style="font-weight:700; color:var(--accent)">Envíos a todo Colombia</div>
          <div class="muted" style="font-size:0.9rem">Pagos seguros con PayPal</div>
        </div>
      </div>
    </section>

    <div class="layout container">
      <section>
        <div id="grid" class="grid" aria-live="polite"></div>
      </section>

      <aside class="aside">
        <div class="cart-header">
          <div>
            <div style="font-weight:700">Tu carrito</div>
            <div class="muted" style="font-size:0.9rem">Artículos listos para comprar</div>
          </div>
          <div class="badge" id="cartCount">0</div>
        </div>

        <ul id="cartList" class="cart-list" aria-live="polite"></ul>
        <div id="cartEmpty" class="muted" style="text-align:center; padding:16px 8px">Tu carrito está vacío — agrega productos</div>

        <div class="total-row">
          <div class="muted">Total</div>
          <div id="cartTotal">0 COP</div>
        </div>

        <div class="checkout">
          <!-- PayPal buttons mounted here -->
          <div id="paypal-button-container"></div>

          <button id="clearCart" class="small-ghost">Vaciar carrito</button>
        </div>
      </aside>
    </div>

    <footer>
      <div class="about">
        <h3>Sobre nosotros</h3>
        <p>Zona Tadeo nace como un proyecto de moda urbana universitaria que fusiona estilo, autenticidad y creatividad. Nuestro objetivo es ofrecer prendas con identidad, pensadas para quienes viven la moda como una forma de expresión.</p>
      </div>

      <div class="contact">
        <h3>Contacto</h3>
        <p>Carrera 4 # 22-61</p>
        <p>Teléfono: (+57) 601 242 7030</p>
        <p>Línea gratuita: 018000111022</p>
        <p>Fax: (+57) 601 561 2107</p>
        <p style="margin-top:12px" class="muted">© Zona Tadeo</p>
      </div>
    </footer>
  </main>

  <div id="toastRoot" aria-hidden></div>

  <script>
    /* ---------- Productos (tus URLs) ---------- */
    const products = [
      { id: 'p1', name: 'Hoodie Black Signature', category:'hoodie', price:120000, img:'https://lh3.googleusercontent.com/gg-dl/ABS2GSkk61v5OZF19YjUTpW3tTL1HqRC9Pi9qWMAuqZ2-YWjPJ98bLd_UorREWd39jdGVB0JBZiy-lC33ZlFrBxEae3QcYDI_cnguo2ZWlVKQS1UyNXxQh-MCSJxNwkWfC9h1ORMk2AHuMaSTCVnaSwk-GLV_-vEdJ6oa6pyJWQREFfEyKimHg=s1024-rj', desc:'Hoodie de algodón, corte moderno, cómodo y calentito.'},
      { id: 'p2', name: 'Hoodie Retro Gray', category:'hoodie', price:115000, img:'https://lh3.googleusercontent.com/gg-dl/ABS2GSmEw5EQqIMptq3UnUoy3hOcqeIVfqpJDIzi-mMUC0V4fRj6eX3svc2eDoLdBvK92xdL0mr2GnHSsQN_zoG3Pkb4M4ieSzhH0xXPFF-d_1KRLHi_R2c0ug9ft_oSZOsBKuEpWRHKhQTisEshyRznCaSBmlsRoml_UNSmO-fbQq1XLc2L=s1024-rj', desc:'Estilo vintage, tejido premium, estampado discreto.'},
      { id: 'p3', name: 'Gorra NYC Flat', category:'gorra', price:75000, img:'https://lh3.googleusercontent.com/gg-dl/ABS2GSk3P_gcEbV6LR1eQLRZ7RUXZFL24jaWxQ3vKZ2_yR-l-K5NNNn381CR8gbGhe2fos3kf8E5_NGZ7DcIjAePux2e2h5HxM7DXuetd5o4Co2KMHq3lxLq4UMCPEVJb68pwqzqFYFmbRq_GD7OQPmzFGj4uNhj5LntiAnZBEAjuTd2LsIz=s1024-rj', desc:'Gorra plana con logo bordado, regulable.'},
      { id: 'p4', name: 'Gorra Classic White', category:'gorra', price:70000, img:'https://chatgpt.com/backend-api/estuary/content?id=file_000000002a7071f5a9e83266c3771a24&ts=489572&p=fs&cid=1&sig=b3a87a94d85ade120850fc77d128d39a4ad0d59c6bf57646706edef63a5780c6&v=0', desc:'Clásica, versátil y fresca.'},
      { id: 'p5', name: 'Buso Oversize Storm', category:'buso', price:99000, img:'https://lh3.googleusercontent.com/gg-dl/ABS2GSkt5uYbAvp8FPXJYN9pGopZ7o9yNquTNmWWqZ3WVXNidSKeHfGVC_LTw1O7-oWV-KQSuzfmRlF-FEJkxUpU9qNPXrG8wfP3kqsq9LHjkCs662Nx_-rF2cq8cDJ3xXTly1ZhJrmccKKqJlcahTVRF-_puRzH7sMO_Qcb8iEj47zoGKmsiw=s1024-rj', desc:'Corte oversize, ideal para looks de calle.'}
    ];

    /* ---------- Estado del carrito ---------- */
    let cart = JSON.parse(localStorage.getItem('zt_cart') || '[]');

    const grid = document.getElementById('grid');
    const cartList = document.getElementById('cartList');
    const cartCount = document.getElementById('cartCount');
    const cartTotalEl = document.getElementById('cartTotal');
    const cartEmpty = document.getElementById('cartEmpty');

    const format = n => new Intl.NumberFormat('es-CO', { style:'currency', currency:'COP' }).format(n);

    /* Render productos */
    function renderProducts(list = products){
      grid.innerHTML = '';
      list.forEach(p => {
        const el = document.createElement('article');
        el.className = 'card';
        el.innerHTML = `
          <div class="thumb"><img loading="lazy" src="${p.img}" alt="${p.name}" onerror="this.src='https://via.placeholder.com/900x600?text=Sin+imagen'"></div>
          <div class="meta"><div class="name">${p.name}</div><div class="price">${format(p.price)}</div></div>
          <div class="desc">${p.desc}</div>
          <div class="actions">
            <button class="btn ghost" onclick="viewProduct('${p.id}')">Ver</button>
            <button class="btn primary" onclick="addToCart('${p.id}')">Agregar</button>
          </div>
        `;
        grid.appendChild(el);
      });
    }

    /* Render carrito */
    function saveCart(){ localStorage.setItem('zt_cart', JSON.stringify(cart)); }

    function renderCart(){
      cartList.innerHTML = '';
      if(cart.length === 0){ cartEmpty.style.display = 'block'; cartList.style.display = 'none'; }
      else { cartEmpty.style.display = 'none'; cartList.style.display = 'flex'; }

      let total = 0, qty = 0;
      cart.forEach(item => {
        total += item.price * item.qty;
        qty += item.qty;

        const li = document.createElement('li');
        li.className = 'cart-item';
        li.innerHTML = `
          <div class="ci-thumb"><img src="${item.img}" onerror="this.src='https://via.placeholder.com/128'"/></div>
          <div class="ci-meta"><div style="font-weight:700">${item.name}</div><div class="muted">${format(item.price)} • x${item.qty}</div></div>
          <div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px">
            <div style="display:flex;gap:8px;align-items:center">
              <button class="small-ghost" onclick="changeQty('${item.id}', -1)">-</button>
              <div class="badge">${item.qty}</div>
              <button class="small-ghost" onclick="changeQty('${item.id}', 1)">+</button>
            </div>
            <button class="small-ghost" style="font-size:0.82rem;color:var(--muted)" onclick="removeItem('${item.id}')">Eliminar</button>
          </div>
        `;
        cartList.appendChild(li);
      });

      cartCount.textContent = qty;
      cartTotalEl.textContent = format(total);
      saveCart();

      // Show PayPal container only if total > 0
      const paypalContainer = document.getElementById('paypal-button-container');
      if(total > 0) paypalContainer.style.display = 'block';
      else paypalContainer.style.display = 'none';

      // Re-render PayPal (so amount updates)
      renderPayPal(total);
    }

    /* Cart ops */
    function addToCart(id){
      const p = products.find(x=>x.id===id);
      const ex = cart.find(c=>c.id===id);
      if(ex) ex.qty++;
      else cart.push({ id:p.id, name:p.name, price:p.price, img:p.img, qty:1 });
      renderCart();
      toast('Producto agregado');
    }
    function changeQty(id, delta){
      const it = cart.find(c=>c.id===id);
      if(!it) return;
      it.qty += delta;
      if(it.qty < 1) cart = cart.filter(c=>c.id!==id);
      renderCart();
    }
    function removeItem(id){ cart = cart.filter(c=>c.id!==id); renderCart(); }

    document.getElementById('clearCart').addEventListener('click', ()=>{
      if(confirm('¿Vaciar carrito?')){ cart = []; renderCart(); }
    });

    /* Simple view modal (native) */
    function viewProduct(id){
      const p = products.find(x=>x.id===id);
      if(!p) return;
      const win = window.open('', '_blank', 'noopener,noreferrer');
      win.document.write(`
        <html><head><title>${p.name}</title>
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <style>body{font-family:Arial,Helvetica,sans-serif;padding:24px;background:#fafafa;color:#111} img{max-width:100%;height:auto;border-radius:8px}</style>
        </head><body>
        <h2>${p.name}</h2><img src="${p.img}" alt="${p.name}" onerror="this.src='https://via.placeholder.com/900x600'"><p style="color:#666">${p.desc}</p><p style="font-weight:700">${format(p.price)}</p>
        <button onclick="window.opener.postMessage({ action:'add', id:'${p.id}' }, '*')">Agregar al carrito</button>
        </body></html>`);
      // Listen for click from child window to add product
      window.addEventListener('message', function handler(e){
        if(e.data && e.data.action === 'add' && e.data.id){
          addToCart(e.data.id);
          window.removeEventListener('message', handler);
          try{ win.close(); }catch(e){}
        }
      });
    }

    // Listen to messages from product view
    window.addEventListener('message', (e)=>{ if(e.data && e.data.action === 'add') addToCart(e.data.id); });

    /* ---------- PayPal ---------- */
    // Renders PayPal Buttons into #paypal-button-container with correct amount
    function renderPayPal(totalAmount){
      const container = document.getElementById('paypal-button-container');
      container.innerHTML = ''; // clear previous
      if(typeof paypal === 'undefined' || totalAmount <= 0) return;

      // Create order
      paypal.Buttons({
        style: { layout: 'vertical', color: 'blue', shape: 'rect', label: 'pay' },
        createOrder: function(data, actions){
          // PayPal expects the amount as a string. Currency COP used as requested.
          return actions.order.create({
            purchase_units: [{
              amount: {
                currency_code: 'COP',
                value: totalAmount.toFixed(2)
              },
              description: 'Compra en Zona Tadeo'
            }]
          });
        },
        onApprove: function(data, actions){
          return actions.order.capture().then(function(details){
            // handle success
            toast('✅ Pago aprobado. Gracias por tu compra.');
            cart = []; renderCart();
          });
        },
        onError: function(err){
          console.error('PayPal error', err);
          alert('Ocurrió un error procesando el pago. Intenta de nuevo.');
        }
      }).render('#paypal-button-container');
    }

    /* ---------- Logo upload preview ---------- */
    const logoInput = document.getElementById('logoInput');
    const logoPreview = document.getElementById('logoPreview');

    logoInput.addEventListener('change', (e)=>{
      const f = e.target.files && e.target.files[0];
      if(!f) return;
      const reader = new FileReader();
      reader.onload = () => {
        logoPreview.style.background = 'transparent';
        logoPreview.innerHTML = `<img src="${reader.result}" alt="Logo" style="width:100%;height:100%;object-fit:contain"/>`;
      }
      reader.readAsDataURL(f);
    });

    /* ---------- Search + small filtering (client side) ---------- */
    const searchInput = document.getElementById('globalSearch');
    searchInput.addEventListener('input', ()=> applyFilters() );

    function applyFilters(){
      const q = searchInput.value.trim().toLowerCase();
      const filtered = products.filter(p => {
        if(!q) return true;
        return p.name.toLowerCase().includes(q) || p.desc.toLowerCase().includes(q);
      });
      renderProducts(filtered);
    }

    /* ---------- Toast helper ---------- */
    function toast(text){
      const root = document.getElementById('toastRoot');
      const el = document.createElement('div');
      el.className = 'toast';
      el.textContent = text;
      root.appendChild(el);
      setTimeout(()=> el.style.opacity = '0', 1500);
      setTimeout(()=> el.remove(), 1900);
    }

    /* Allow adding product from popup (postMessage) */
    window.addEventListener('message', (e)=>{
      if(e.data && e.data.addProductId) addToCart(e.data.addProductId);
    });

    /* Initialize */
    renderProducts();
    renderCart();

    // If child window requests add (fallback)
    window.addEventListener('message', (e)=>{
      if(e.data && e.data.action === 'add' && e.data.id) addToCart(e.data.id);
    });
  </script>
</body>
</html>
